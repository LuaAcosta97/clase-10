
const productos = [
    // vestidos
    {
        id: "Vestido-06",
        titulo: "Vestido 6",
        imagen: "https://acdn.mitiendanube.com/stores/001/053/068/products/gianduia-1-d3d27575f81e2b4b6817008279076118-1024-1024.webp",
        categoria: {
            nombre: "Vestidos",
            id: "Vestidos"
        },
        precio: 1000
    }, 
    {
        id: "Vestido-06",
        titulo: "Vestido 6",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/cam-zule1-c5c514c3d2e318003016929929076096-1024-1024.webp",
        categoria: {
            nombre: "Vestidos",
            id: "Vestidos"
        },
        precio: 1000
    }, 
    {
        id: "Vestido-06",
        titulo: "Vestido 6",
        imagen: "https://acdn.mitiendanube.com/stores/001/053/068/products/praga-ecc6906711774196ee169807002529981-78a23f3d9b972e35c516980700505720-1024-1024.webp",
        categoria: {
            nombre: "Vestidos",
            id: "Vestidos"
        },
        precio: 1000
    }, 
    {
        id: "Vestido-06",
        titulo: "Vestido lino expandex 6",
        imagen: "https://acdn.mitiendanube.com/stores/001/053/068/products/azalea-1-4c8201ce85b335c1f017008273016979-1024-1024.webp",
        categoria: {
            nombre: "Vestidos",
            id: "Vestidos"
        },
        precio: 1000
    }, 
    {
        id: "Vestido-06",
        titulo: "Vestido 6",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/cam-zule1-c5c514c3d2e318003016929929076096-1024-1024.webp",
        categoria: {
            nombre: "Vestidos",
            id: "Vestidos"
        },
        precio: 1000
    }, 
    
    // blusas
    {
        id: "Blusa-01",
        titulo: "Blusa Helen 1",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/028a19271-608ba7ad9948fc4eee16464204681723-1024-1024.webp",
        categoria: {
            nombre: "Blusas",
            id: "Blusas"
        },
        precio: 1000
    },
    {
        id: "Blusa-01",
        titulo: "Blusa Helen 1",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/028a19271-608ba7ad9948fc4eee16464204681723-1024-1024.webp",
        categoria: {
            nombre: "Blusas",
            id: "Blusas"
        },
        precio: 1000
    },
    {
        id: "Blusa-03",
        titulo: "camisola 3",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/028a3560-min1-3a699490cb0517382516506634795627-1024-1024.webp",
        categoria: {
            nombre: "Blusas",
            id: "Blusas"
        },
        precio: 1000
    },
    {
        id: "Blusa-01",
        titulo: "Blusa Helen 1",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/028a19271-608ba7ad9948fc4eee16464204681723-1024-1024.webp",
        categoria: {
            nombre: "Blusas",
            id: "Blusas"
        },
        precio: 1000
    },

    // camisas
    {
        id: "camisa-01",
        titulo: "camisa 1 ",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/cam-flow411-41bc4dc42b8d15e62516936029055335-1024-1024.webp",
        categoria: {
            nombre: "Camisas",
            id: "camisas"
        },
        precio: 1000
    },
    {
        id: "camisa-02",
        titulo: "camisa 2",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/0a011-009-31-62dbff81c1e9a933a516639568020746-1024-1024.webp",
        categoria: {
            nombre: "Camisas",
            id: "camisas"
        },
        precio: 1000
    },
    {
        id: "camisa-03",
        titulo: "camisa 3",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/cam-let-it-be21-1bb97b541fe7cf9dfe16957434708234-1024-1024.webp",
        categoria: {
            nombre: "Camisas",
            id: "camisas"
        },
        precio: 1000
    },
    {
        id: "camisa-04",
        titulo: "camisa 4",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/028a35221-124de9def1885a3d5616496962980921-1024-1024.webp",
        categoria: {
            nombre: "Camisas",
            id: "camisas"
        },
        precio: 1000
    },
     {
        id: "camisa-05",
        titulo: "camisa 5",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/cam-zule1-c5c514c3d2e318003016929929076096-1024-1024.webp",
        categoria: {
            nombre: "Camisas",
            id: "camisas"
        },
        precio: 1000
    },
    // pantalones
    {
        id: "pantalones-01",
        titulo: "pantalon 1",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/harold1-41c8081708f4fed72716782238059527-1024-1024.webp",
        categoria: {
            nombre: "Pantalones",
            id: "pantalones"
        },
        precio: 1000
    },
    {
        id: "pantalones-02",
        titulo: "pantalon 2",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/whatsapp-image-2023-04-18-at-15-14-12-21-1ac4d10aa6a4fc168616818419262263-1024-1024.webp",
        categoria: {
            nombre: "Pantalones",
            id: "pantalones"
        },
        precio: 1000
    },
    {
        id: "pantalones-03",
        titulo: "pantalon 3",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/jean-pink-0n601-020-011-579c532fd872705b2616656280214419-1024-1024.webp",
        categoria: {
            nombre: "Pantalones",
            id: "pantalones"
        },
        precio: 1000
    },
    {
        id: "pantalones-04",
        titulo: "pantalon 4",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/grey21-b9d2d3d5a25fd4c6d416788206559900-1024-1024.webp",
        categoria: {
            nombre: "Pantalones",
            id: "pantalones"
        },
        precio: 1000
    },
    {
        id: "pantalones-05",
        titulo: "pantalon 5",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/cargonoel41-ffcb6ab52515b8a1b416820982700654-1024-1024.jpg",
        categoria: {
            nombre: "Pantalones",
            id: "pantalones"
        },
        precio: 1000
    },
    // Abrigos
    {
        id: "abrigo-1",
        titulo: "abrigo 1",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/camp-iris311-a08c07bd565dfc1e8916811430148579-1024-1024.webp",
        categoria: {
            nombre: "Abrigos",
            id: "abrigos"
        },
        precio: 1000
    },
    {
        id: "abrigo-02",
        titulo: "abrigo 2",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/whatsapp-image-2023-04-14-at-12-40-15-21-16928400bd1e67850516814868914238-640-0.jpeg",
        categoria: {
            nombre: "Abrigos",
            id: "abrigos"
        },
        precio: 1000
    },
    {
        id: "abrigo-03",
        titulo: "abrigo 3",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/whatsapp-image-2023-04-18-at-15-26-53-11-1a2475b4e7b3915e2116818425629941-1024-1024.webp",
        categoria: {
            nombre: "Abrigos",
            id: "abrigos"
        },
        precio: 1000
    },
    {
        id: "abrigo-04",
        titulo: "abrigo 4",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/whatsapp-image-2023-04-19-at-19-07-131-d4e929b6acfbcc9e5916819421875056-1024-1024.webp",
        categoria: {
            nombre: "Abrigos",
            id: "abrigos"
        },
        precio: 1000
    },
    {
        id: "abrigo-05",
        titulo: "abrigo 5",
        imagen: "https://acdn.mitiendanube.com/stores/001/317/859/products/tapado-regina1-41074d775e5d8d692216851233232289-1024-1024.webp",
        categoria: {
            nombre: "Abrigos",
            id: "abrigos"
        },
        precio: 1000
    }

];

const bannerAlert = [
    {imagen : "img/ofertas-efectivo.png"}
];


const contenedorProductos = document.getElementById("contenedor-productos");
const botonesCategorias = document.querySelectorAll(".boton-categoria");
const tituloPrincipal = document.getElementById("titulo-principal");
let botonesAgregar = document.querySelectorAll(".producto-agregar");
const numerito = document.getElementById("numerito");


Swal.fire({
    html:`<div>

     <img  class="animate__animate__backInDownn alert-inicio-prods" src="img/ofertas-efectivo.png" alt="intro-de-pagina - "></img>
    </div>`,
    confirmButtonText:'ver productos'
}); 


function cargarProductos(productosElegidos) {
    contenedorProductos.innerHTML = "";

    productosElegidos.forEach(producto => {

        const div = document.createElement("div");
        div.classList.add("producto");
        div.innerHTML = `
                <img class="producto-imagen" src="${producto.imagen}" alt="${producto.titulo}">
                 <div class="producto-detalles">
                        <h3 class="producto-titulo">${producto.titulo}</h3>
                        <p class="producto-precio">$${producto.precio}</p>
                        <button class="producto-agregar" id="${producto.id}">agregar </button>
                 </div> 
    `;
        contenedorProductos.append(div);
    })
    actualizarBotonesAgregar();
};

cargarProductos(productos);

botonesCategorias.forEach(boton => {
    // e.currentTarget =el e hace referencia a event
    // este evento se utiliza para identificar al elemento actual, antes de que pase por el DOM.
    boton.addEventListener("click", (e) => {
        // recoremos cada boton categoria para que se active el selecionado, y el anterior se desactive
        botonesCategorias.forEach(boton => boton.classList.remove("active"));
        e.currentTarget.classList.add("active");
        // si no se selecciona el boton todos los productos(id), buscamos y cambiamos el tituloPrincipal por su nombre de categoria 
        if (e.currentTarget.id != "todos") {
            const productoCategoria = productos.find(producto => producto.categoria.id === e.currentTarget.id);
            tituloPrincipal.innerText = productoCategoria.categoria.nombre;
            // filtramos los productos por su categoria id y los llamamos usando el parametro de la funcion en la que se guardo el filter
            const productosBoton = productos.filter(producto => producto.categoria.id === e.currentTarget.id);
            cargarProductos(productosBoton);
            console.log()
        } else {
            // al volver al boton todos los productos, vuelve  al titulo y se cargan todos los productos
            tituloPrincipal.innerText = "Todos los productos";
            cargarProductos(productos);
        }

    })
});
// primero arriba declaramos a botonesAgregar, y haca re definimos cada boton, los recorremos y le agregamos el evento click cada vez que se cargan los productos
function actualizarBotonesAgregar() {
    botonesAgregar = document.querySelectorAll(".producto-agregar");

    botonesAgregar.forEach(boton => {
        boton.addEventListener("click", agregarAlCArrito);
    });

}


let productosEnCarrito;

const productosEnCarritoLS = JSON.parse(localStorage.getItem("productos-en-carrito"));

if (productosEnCarritoLS) {
   productosEnCarrito = productosEnCarritoLS;
   actualizarNumerito();
} else {
    productosEnCarrito = [];
}


// 
function agregarAlCArrito(e) {
    // hacemos que el boton de agregar, reconozca a cada producto por su Id y que al seleccionarlo lo traiga y lo guarde en idBoton  
    const idBoton = e.currentTarget.id;
    const productoAgregado = productos.find(producto => producto.id === idBoton);
    
    Swal.fire({
        title: '¡Agregado al carrito!',
        html:`<div>
       
         <img class="imagen-alert" src="${productoAgregado.imagen}" alt="${productoAgregado.titulo}"></img>
          <p>${productoAgregado.titulo} fue agregado correctamente</p>
        </div>`,
        confirmButtonText: 'Aceptar'
    }); 

// --some-- devuelve true o false (que nos va a indicar si el poroducto esta agregado o no al carrito)

// if true = el producto ya esta en el carrito, entonces va a aumentar su cantidad 
    if (productosEnCarrito.some(producto => producto.id === idBoton)) {
        // busca la ubicacion el producto ya agregado al carrito(orden en que se agrego), mostrando su ubicacion como array
        const index = productosEnCarrito.findIndex(producto => producto.id ===idBoton);
        productosEnCarrito[index].cantidad++;
// else false = el producto no estaba en el carrito y lo agrega
    } else {
        // le agregamos la propiedad de cantidad
        productoAgregado.cantidad = 1;
        productosEnCarrito.push(productoAgregado);
    }

    actualizarNumerito(); 
    // (funciona de adentro hacia afuera) 
    // El JSON.stringify transforma el objeto js a un string JSON y luego el setItem lo guarda en el localStorage
    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));
}
//  el numerito del boton carrito se actualice al agregar productos
function actualizarNumerito(){
    let nuevoNumerito =  productosEnCarrito.reduce((acc, producto) => acc + producto.cantidad,0);
    numerito.innerText = nuevoNumerito;
}